describe("Quoting.ChargeItem", function() {
  var ChargeItem = require("Quoting.ChargeItem")
  var chargeItem

  beforeEach(function() {
    chargeItem = new ChargeItem()
  })

  describe("#onCostPerUnitChange", function(){
    it("updates markup per unit and charge per unit", function(){
      chargeItem = new ChargeItem({costPerUnit: 1, percentageMarkup: 5})

      chargeItem.costPerUnit = 2
      chargeItem.onCostPerUnitChange()

      expect(chargeItem.markupPerUnit).toEqual(0.1)
      expect(chargeItem.chargePerUnit).toEqual(2.1)
    })
  })

  describe("#onMarkupPercentageChange", function(){
    it("updates markup per unit and charge per unit", function(){
      chargeItem = new ChargeItem({costPerUnit: 1, percentageMarkup: 1})

      chargeItem.percentageMarkup = 5
      chargeItem.onPercentageMarkupChange()

      expect(chargeItem.markupPerUnit).toEqual(0.05)
      expect(chargeItem.chargePerUnit).toEqual(1.05)
    })
  })

  describe("#onChargePerUnitChange", function(){
    it ("updates markup per unit and markup percentage", function(){
      chargeItem = new ChargeItem({costPerUnit: 2, chargePerUnit: 2})

      chargeItem.chargePerUnit = 4
      chargeItem.onChargePerUnitChange()

      expect(chargeItem.markupPerUnit).toEqual(2)
      expect(chargeItem.percentageMarkup).toEqual(100)
    })

    it("sets markup percentage to 0 when cost per unit is 0", function() {
      chargeItem = new ChargeItem({costPerUnit: 0, chargePerUnit: 2})

      chargeItem.chargePerUnit = 4
      chargeItem.onChargePerUnitChange()

      expect(chargeItem.percentageMarkup).toEqual(0)
    })
  })
})
